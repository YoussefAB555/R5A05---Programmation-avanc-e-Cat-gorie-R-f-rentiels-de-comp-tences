{% extends 'applitravel/base.html' %}
{% block title %}Détail voyage{% endblock %}
{% block main %}
<h2>{{ voyage }}</h2>
<table class='table table-striped'>
  <thead><tr><th>Ville</th><th>Jours</th></tr></thead>
  <tbody>
  {% for e in etapes %}<tr><td>{{ e.ville }}</td><td>{{ e.nbJours }}</td><td><button class='btn btn-sm btn-outline-secondary' onclick='fillEtapeForm({{ e.ville.IDVille }}, {{ e.nbJours }})'>Modifier</button> <a class='btn btn-sm btn-outline-danger' href='{% url 'etape-delete' voyage_id=voyage.IDVoyage etape_id=e.IDEtape %}'>Supprimer</a></td></tr>
  {% empty %}<tr><td colspan='2'>Aucune étape</td></tr>{% endfor %}
  </tbody>
</table>
<h2>Ajouter une étape</h2>
<form action="{% url 'etape-add' voyage_id=voyage.IDVoyage %}" method="post">
    {% csrf_token %}
    <div class="mb-3">

        <label for="id_ville" class="form-label">Etape</label>
        <select name="ville" class="form-select" required id ="id_ville">
            <option selected disabled value="">Choisissez</option>
            {% for vil in lesVilles %}
            <option value="{{vil.IDVille}}">{{vil.NomVille}}</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="id_nbjours" class="form-Label">Nombre de jours</label>
        <input type="text" name="Nb_Jours" class="form_control" maxlength="10"  required id="id_nbjours">
    </div>
    <button type="submit">Ajouter</button>
<script>
function fillEtapeForm(villeId, nbJours) {
    document.getElementById('id_ville').value = villeId;
    document.getElementById('id_nbjours').value = nbJours;
}
</script>
{% endblock %}